<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Ã‡Ä±tkÄ±rÄ±ldÄ±m FÄ±ndÄ±k ve FÄ±ndÄ±k ÃœrÃ¼nleri Giresunnuts SipariÅŸ Formu</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* CSS: Ã–nceki kodda kullanÄ±lan aynÄ± stiller buraya dahildir */
        body { font-family: Arial, sans-serif; background-color: #f4f4f9; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #38761d; font-size: 1.5em; }
        .product-group { border: 1px solid #ddd; border-radius: 5px; padding: 10px; margin-bottom: 20px; }
        .product-group h3 { margin-top: 0; color: #b76c33; font-size: 1.2em; }
        .option { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px dashed #eee; }
        .product-info { display: flex; flex-direction: column; flex-grow: 1; padding-right: 10px; }
        .weight-price-row { display: flex; justify-content: space-between; align-items: center; width: 100%; }
        .unit-price { font-size: 12px; color: #555; margin-top: 2px; }
        .sub-total { font-weight: bold; color: #007bff; min-width: 70px; text-align: right; }
        .quantity-control { display: flex; align-items: center; margin-left: 10px; min-width: 100px; }
        .quantity-control button { background-color: #38761d; color: white; border: none; padding: 8px 12px; cursor: pointer; border-radius: 4px; font-size: 16px; line-height: 1; }
        .quantity-control input { width: 40px; text-align: center; border: 1px solid #ccc; margin: 0 5px; padding: 7px 0; font-size: 16px; -moz-appearance: textfield; appearance: textfield; }
        .quantity-control input::-webkit-outer-spin-button,
        .quantity-control input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .quantity-control button:hover { background-color: #2d5a15; }
        .quantity-control button:active { transform: scale(0.95); }
        #total-container { padding: 15px; background-color: #f6b26b; color: #4a2d1f; border-radius: 5px; margin-top: 20px; font-size: 1.3em; font-weight: bold; text-align: center; }
        #proceedButton { width: 100%; padding: 15px; background-color: #38761d; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; margin-top: 10px; transition: background-color 0.3s; }
        #proceedButton:hover { background-color: #2d5a15; }
        #proceedButton:disabled { background-color: #ccc; cursor: not-allowed; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 20px; border: 1px solid #888; border-radius: 8px; width: 90%; max-width: 500px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close:hover { color: #000; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; color: #333; font-weight: bold; }
        .form-group input, .form-group textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 16px; box-sizing: border-box; }
        .form-group textarea { resize: vertical; min-height: 80px; }
        .form-group input:focus, .form-group textarea:focus { outline: none; border-color: #38761d; }
        .error-message { color: #d32f2f; font-size: 14px; margin-top: 5px; display: none; }
        .form-group input.error, .form-group textarea.error { border-color: #d32f2f; }
        @media (max-width: 600px) {
            .container { padding: 15px; }
            h1 { font-size: 1.2em; }
            .option { flex-direction: column; align-items: flex-start; }
            .quantity-control { margin-top: 10px; margin-left: 0; width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŒ° Ã‡Ä±tkÄ±rÄ±ldÄ±m FÄ±ndÄ±k ve FÄ±ndÄ±k ÃœrÃ¼nleri<br>Giresunnuts SipariÅŸ Formu</h1>
        <form id="orderForm">
            
            <div class="product-group">
                <h3>Kabuklu FÄ±ndÄ±k</h3>
                <div class="option" data-name="Kabuklu FÄ±ndÄ±k" data-weight="500 gr" data-price="225">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">500 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">225,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="Kabuklu FÄ±ndÄ±k" data-weight="1 kg" data-price="450">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">1 kg</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">450,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
            </div>

            <div class="product-group">
                <h3>KavrulmuÅŸ FÄ±ndÄ±k</h3>
                <div class="option" data-name="KavrulmuÅŸ FÄ±ndÄ±k" data-weight="50 gr" data-price="65">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">50 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">65,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="KavrulmuÅŸ FÄ±ndÄ±k" data-weight="100 gr" data-price="130">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">100 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">130,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="KavrulmuÅŸ FÄ±ndÄ±k" data-weight="250 gr" data-price="325">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">250 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">325,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="KavrulmuÅŸ FÄ±ndÄ±k" data-weight="500 gr" data-price="650">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">500 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">650,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="KavrulmuÅŸ FÄ±ndÄ±k" data-weight="1 kg" data-price="1300">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">1 kg</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">1.300,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
            </div>

            <div class="product-group">
                <h3>Pikola FÄ±ndÄ±k</h3>
                <div class="option" data-name="Pikola FÄ±ndÄ±k" data-weight="50 gr" data-price="87.5">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">50 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">87,50 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="Pikola FÄ±ndÄ±k" data-weight="100 gr" data-price="175">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">100 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">175,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="Pikola FÄ±ndÄ±k" data-weight="250 gr" data-price="437.5">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">250 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">437,50 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
            </div>

            <div class="product-group">
                <h3>Krokan</h3>
                <div class="option" data-name="Krokan" data-weight="40 gr" data-price="70">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">40 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">70,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="Krokan" data-weight="100 gr" data-price="175">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">100 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">175,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="Krokan" data-weight="250 gr" data-price="437.5">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">250 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">437,50 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="Krokan" data-weight="1 kg" data-price="1750">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">1 kg</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">1.750,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
            </div>
            
            <div class="product-group">
                <h3>FÄ±ndÄ±k Ezmesi</h3>
                <div class="option" data-name="FÄ±ndÄ±k Ezmesi" data-weight="100 gr" data-price="100">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">100 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">100,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="FÄ±ndÄ±k Ezmesi" data-weight="200 gr" data-price="200">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">200 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">200,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="FÄ±ndÄ±k Ezmesi" data-weight="300 gr" data-price="300">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">300 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">300,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="FÄ±ndÄ±k Ezmesi" data-weight="400 gr" data-price="400">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">400 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">400,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
            </div>
            
            <div class="product-group">
                <h3>FÄ±ndÄ±k YaÄŸÄ±</h3>
                <div class="option" data-name="FÄ±ndÄ±k YaÄŸÄ±" data-weight="1 Lt" data-price="250">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">1 Lt</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">250,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="FÄ±ndÄ±k YaÄŸÄ±" data-weight="2 Lt" data-price="500">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">2 Lt</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">500,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
            </div>

            <div class="product-group">
                <h3>Kestane BalÄ±</h3>
                <div class="option" data-name="Kestane BalÄ±" data-weight="300 gr" data-price="660">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">300 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">660,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="Kestane BalÄ±" data-weight="400 gr" data-price="880">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">400 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">880,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="Kestane BalÄ±" data-weight="800 gr" data-price="1760">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">800 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">1.760,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="Kestane BalÄ±" data-weight="1 kg" data-price="2200">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">1 kg</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">2.200,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
            </div>

            <div class="product-group">
                <h3>Ã‡iÃ§ek BalÄ±</h3>
                <div class="option" data-name="Ã‡iÃ§ek BalÄ±" data-weight="300 gr" data-price="375">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">300 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">375,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="Ã‡iÃ§ek BalÄ±" data-weight="400 gr" data-price="500">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">400 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">500,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="Ã‡iÃ§ek BalÄ±" data-weight="800 gr" data-price="1000">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">800 gr</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">1.000,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
                <div class="option" data-name="Ã‡iÃ§ek BalÄ±" data-weight="1 kg" data-price="1250">
                    <div class="product-info"><div class="weight-price-row"><span class="weight">1 kg</span><span class="sub-total">0 â‚º</span></div><span class="unit-price">1.250,00 â‚º / adet</span></div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
            </div>
            
            <div class="product-group">
                <h3>Ã‡ay</h3>
                <div class="option" data-name="Ã‡ay" data-weight="500 gr" data-price="175">
                    <div class="product-info">
                        <div class="weight-price-row"><span class="weight">500 gr</span><span class="sub-total">0 â‚º</span></div>
                        <span class="unit-price">175,00 â‚º / adet</span>
                    </div>
                    <div class="quantity-control"><button type="button" class="decrease">-</button><input type="number" value="0" min="0" readonly><button type="button" class="increase">+</button></div>
                </div>
            </div>

            <hr>
            
            <div id="total-container">
                Genel Toplam: <span id="total-price">0,00 â‚º</span>
            </div>

            <button type="button" id="proceedButton">Bilgileri Gir ve PDF OluÅŸturmaya GeÃ§</button>
        </form>
    </div>

    <!-- MÃ¼ÅŸteri Bilgileri Modal -->
    <div id="customerModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 style="color: #38761d; margin-top: 0;">MÃ¼ÅŸteri Bilgileri</h2>
            <form id="customerForm">
                <div class="form-group">
                    <label for="customerName">Ad Soyad <span style="color: red;">*</span></label>
                    <input type="text" id="customerName" name="customerName" required>
                    <div class="error-message" id="nameError">LÃ¼tfen ad soyad giriniz.</div>
                </div>
                <div class="form-group">
                    <label for="customerPhone">Telefon <span style="color: red;">*</span></label>
                    <input type="tel" id="customerPhone" name="customerPhone" placeholder="05XX XXX XX XX" required>
                    <div class="error-message" id="phoneError">GeÃ§erli bir telefon numarasÄ± giriniz.</div>
                </div>
                <div class="form-group">
                    <label for="customerAddress">Adres <span style="color: red;">*</span></label>
                    <textarea id="customerAddress" name="customerAddress" required></textarea>
                    <div class="error-message" id="addressError">LÃ¼tfen adres bilgisi giriniz.</div>
                </div>
                <div class="form-group">
                    <label for="customerNote">Notlar (Opsiyonel)</label>
                    <textarea id="customerNote" name="customerNote" placeholder="Teslimat veya sipariÅŸ ile ilgili notlarÄ±nÄ±z..."></textarea>
                </div>
                <button type="submit" style="width: 100%; padding: 15px; background-color: #38761d; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; margin-top: 10px;">PDF OluÅŸtur ve Ä°ndir</button>
            </form>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.min.js"></script>

    <script>
        // JavaScript BaÅŸlangÄ±cÄ±: Fiyat Hesaplama ve Miktar KontrolÃ¼
        document.addEventListener('DOMContentLoaded', () => {
            const totalPriceElement = document.getElementById('total-price');
            const options = document.querySelectorAll('.option');
            const proceedButton = document.getElementById('proceedButton');

            /**
             * Genel toplamÄ± ve ilgili ara toplamlarÄ± gÃ¼nceller.
             * @param {HTMLElement} option - YalnÄ±zca bir Ã¼rÃ¼nÃ¼ gÃ¼ncellemek iÃ§in kullanÄ±lÄ±r.
             */
            function updatePrice(option = null) {
                
                const optionsToUpdate = option ? [option] : options;

                optionsToUpdate.forEach(item => {
                    const quantityInput = item.querySelector('input');
                    const subTotalElement = item.querySelector('.sub-total');
                    
                    const quantity = parseInt(quantityInput.value);
                    const price = parseFloat(item.getAttribute('data-price'));
                    
                    let subTotal = 0;
                    if (quantity > 0 && !isNaN(price)) {
                        subTotal = quantity * price;
                    }
                    
                    // Ara ToplamÄ± GÃ¼ncelle
                    subTotalElement.textContent = subTotal.toFixed(2).replace('.', ',') + ' â‚º';
                });

                // TÃ¼m Ã¼rÃ¼nleri tekrar dolaÅŸarak Genel ToplamÄ± Hesapla
                let total = 0;
                options.forEach(item => {
                    const quantity = parseInt(item.querySelector('input').value);
                    const price = parseFloat(item.getAttribute('data-price'));
                    if (quantity > 0 && !isNaN(price)) {
                        total += quantity * price;
                    }
                });
                
                // Genel ToplamÄ± GÃ¼ncelle
                totalPriceElement.textContent = total.toFixed(2).replace('.', ',') + ' â‚º';
            }

            // Miktar Kontrol ButonlarÄ±na Dinleyici Ekle
            options.forEach(option => {
                const increaseButton = option.querySelector('.increase');
                const decreaseButton = option.querySelector('.decrease');
                const input = option.querySelector('input');

                // ArtÄ±rma butonu
                increaseButton.addEventListener('click', () => {
                    input.value = parseInt(input.value) + 1;
                    updatePrice(option); 
                });

                // Azaltma butonu
                decreaseButton.addEventListener('click', () => {
                    let value = parseInt(input.value);
                    if (value > 0) {
                        input.value = value - 1;
                        updatePrice(option); 
                    }
                });
            });
            
            // Modal Ä°ÅŸlemleri
            const modal = document.getElementById('customerModal');
            const closeBtn = document.querySelector('.close');
            const customerForm = document.getElementById('customerForm');

            proceedButton.addEventListener('click', () => {
                const selectedProducts = [];
                let finalTotal = 0;

                document.querySelectorAll('.option').forEach(option => {
                    const quantity = parseInt(option.querySelector('input').value);
                    const price = parseFloat(option.getAttribute('data-price'));

                    if (quantity > 0) {
                        const productName = option.getAttribute('data-name');
                        const productWeight = option.getAttribute('data-weight');
                        const subtotal = (quantity * price);
                        finalTotal += subtotal;

                        selectedProducts.push({
                            name: productName,
                            weight: productWeight,
                            quantity: quantity,
                            price: price,
                            subtotal: subtotal
                        });
                    }
                });

                if (selectedProducts.length > 0) {
                    window.selectedProducts = selectedProducts;
                    window.finalTotal = finalTotal;
                    modal.style.display = 'block';
                } else {
                    alert("LÃ¼tfen sepetinize en az bir Ã¼rÃ¼n ekleyin.");
                }
            });

            closeBtn.addEventListener('click', () => {
                modal.style.display = 'none';
            });

            window.addEventListener('click', (event) => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });

            // Form Validasyonu
            function validatePhone(phone) {
                const phoneRegex = /^0[5][0-9]{9}$/;
                return phoneRegex.test(phone.replace(/\s/g, ''));
            }

            function showError(fieldId, errorId, message) {
                const field = document.getElementById(fieldId);
                const error = document.getElementById(errorId);
                field.classList.add('error');
                error.textContent = message;
                error.style.display = 'block';
            }

            function hideError(fieldId, errorId) {
                const field = document.getElementById(fieldId);
                const error = document.getElementById(errorId);
                field.classList.remove('error');
                error.style.display = 'none';
            }

            // Form Submit Ä°ÅŸlemi
            customerForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const name = document.getElementById('customerName').value.trim();
                const phone = document.getElementById('customerPhone').value.trim();
                const address = document.getElementById('customerAddress').value.trim();
                const note = document.getElementById('customerNote').value.trim();

                let isValid = true;

                // Validasyonlar
                if (!name) {
                    showError('customerName', 'nameError', 'LÃ¼tfen ad soyad giriniz.');
                    isValid = false;
                } else {
                    hideError('customerName', 'nameError');
                }

                if (!phone) {
                    showError('customerPhone', 'phoneError', 'LÃ¼tfen telefon numarasÄ± giriniz.');
                    isValid = false;
                } else if (!validatePhone(phone)) {
                    showError('customerPhone', 'phoneError', 'GeÃ§erli bir telefon numarasÄ± giriniz. (05XX XXX XX XX)');
                    isValid = false;
                } else {
                    hideError('customerPhone', 'phoneError');
                }

                if (!address) {
                    showError('customerAddress', 'addressError', 'LÃ¼tfen adres bilgisi giriniz.');
                    isValid = false;
                } else {
                    hideError('customerAddress', 'addressError');
                }

                if (isValid) {
                    generatePDF({
                        name: name,
                        phone: phone,
                        address: address,
                        note: note,
                        products: window.selectedProducts,
                        total: window.finalTotal
                    });
                    modal.style.display = 'none';
                    customerForm.reset();
                }
            });

            // PDF OluÅŸturma Fonksiyonu - PDFMake ile TÃ¼rkÃ§e karakter desteÄŸi
            function generatePDF(data) {
                const now = new Date();
                const day = String(now.getDate()).padStart(2, '0');
                const monthNames = ['Ocak', 'Åžubat', 'Mart', 'Nisan', 'MayÄ±s', 'Haziran', 
                                   'Temmuz', 'AÄŸustos', 'EylÃ¼l', 'Ekim', 'KasÄ±m', 'AralÄ±k'];
                const month = monthNames[now.getMonth()];
                const year = now.getFullYear();
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const dateStr = `${day} ${month} ${year} ${hours}:${minutes}`;

                // ÃœrÃ¼n tablosu iÃ§in satÄ±rlar
                const productRows = data.products.map((product, index) => {
                    const rowColor = index % 2 === 0 ? '#fafafa' : '#ffffff';
                    return [
                        {
                            text: `${product.name} (${product.weight})`,
                            fillColor: rowColor
                        },
                        {
                            text: `${product.quantity} adet`,
                            fillColor: rowColor,
                            alignment: 'center'
                        },
                        {
                            text: `${product.price.toFixed(2).replace('.', ',')} â‚º`,
                            fillColor: rowColor,
                            alignment: 'right'
                        },
                        {
                            text: `${product.subtotal.toFixed(2).replace('.', ',')} â‚º`,
                            fillColor: rowColor,
                            alignment: 'right'
                        }
                    ];
                });

                const docDefinition = {
                    pageSize: 'A4',
                    pageMargins: [40, 60, 40, 60],
                    defaultStyle: {
                        font: 'Roboto',
                        fontSize: 11
                    },
                    content: [
                        // BaÅŸlÄ±k BÃ¶lÃ¼mÃ¼
                        {
                            stack: [
                                {
                                    text: 'Ã‡Ä±tkÄ±rÄ±ldÄ±m FÄ±ndÄ±k ve FÄ±ndÄ±k ÃœrÃ¼nleri',
                                    fontSize: 22,
                                    bold: true,
                                    color: '#ffffff',
                                    alignment: 'center',
                                    margin: [0, 0, 0, 5]
                                },
                                {
                                    text: 'Giresunnuts SipariÅŸ Formu',
                                    fontSize: 16,
                                    color: '#ffffff',
                                    alignment: 'center'
                                }
                            ],
                            fillColor: '#38761d',
                            margin: [-40, -60, -40, 20],
                            padding: [20, 0, 20, 0]
                        },
                        
                        // MÃ¼ÅŸteri Bilgileri
                        {
                            text: 'MÃ¼ÅŸteri Bilgileri',
                            fontSize: 14,
                            bold: true,
                            color: '#38761d',
                            margin: [0, 0, 0, 10],
                            fillColor: '#f0f0f0',
                            padding: [5, 0, 5, 0]
                        },
                        {
                            columns: [
                                {
                                    width: 80,
                                    text: 'Ad Soyad:',
                                    bold: true
                                },
                                {
                                    width: '*',
                                    text: data.name
                                }
                            ],
                            margin: [0, 0, 0, 5]
                        },
                        {
                            columns: [
                                {
                                    width: 80,
                                    text: 'Telefon:',
                                    bold: true
                                },
                                {
                                    width: '*',
                                    text: data.phone
                                }
                            ],
                            margin: [0, 0, 0, 5]
                        },
                        {
                            columns: [
                                {
                                    width: 80,
                                    text: 'Adres:',
                                    bold: true
                                },
                                {
                                    width: '*',
                                    text: data.address
                                }
                            ],
                            margin: [0, 0, 0, 5]
                        },
                        ...(data.note ? [{
                            columns: [
                                {
                                    width: 80,
                                    text: 'Not:',
                                    bold: true
                                },
                                {
                                    width: '*',
                                    text: data.note
                                }
                            ],
                            margin: [0, 0, 0, 10]
                        }] : [{ text: '', margin: [0, 0, 0, 10] }]),

                        // SipariÅŸ DetaylarÄ±
                        {
                            text: 'SipariÅŸ DetaylarÄ±',
                            fontSize: 14,
                            bold: true,
                            color: '#38761d',
                            margin: [0, 0, 0, 10],
                            fillColor: '#f0f0f0',
                            padding: [5, 0, 5, 0]
                        },
                        
                        // ÃœrÃ¼n Tablosu
                        {
                            table: {
                                headerRows: 1,
                                widths: ['*', 60, 80, 80],
                                body: [
                                    [
                                        {
                                            text: 'ÃœrÃ¼n',
                                            bold: true,
                                            color: '#ffffff',
                                            fillColor: '#38761d'
                                        },
                                        {
                                            text: 'Miktar',
                                            bold: true,
                                            color: '#ffffff',
                                            fillColor: '#38761d',
                                            alignment: 'center'
                                        },
                                        {
                                            text: 'Birim Fiyat',
                                            bold: true,
                                            color: '#ffffff',
                                            fillColor: '#38761d',
                                            alignment: 'right'
                                        },
                                        {
                                            text: 'Toplam',
                                            bold: true,
                                            color: '#ffffff',
                                            fillColor: '#38761d',
                                            alignment: 'right'
                                        }
                                    ],
                                    ...productRows
                                ]
                            },
                            layout: {
                                paddingLeft: function(i) { return i === 0 ? 5 : 5; },
                                paddingRight: function(i) { return i === 0 ? 5 : 5; },
                                paddingTop: function(i) { return i === 0 ? 5 : 5; },
                                paddingBottom: function(i) { return i === 0 ? 5 : 5; }
                            },
                            margin: [0, 0, 0, 10]
                        },

                        // Genel Toplam
                        {
                            text: `GENEL TOPLAM: ${data.total.toFixed(2).replace('.', ',')} â‚º`,
                            fontSize: 16,
                            bold: true,
                            color: '#4a2d1f',
                            alignment: 'right',
                            fillColor: '#f6b26b',
                            margin: [0, 10, 0, 20],
                            padding: [10, 5, 10, 5]
                        },

                        // Tarih
                        {
                            text: `SipariÅŸ Tarihi: ${dateStr}`,
                            fontSize: 9,
                            color: '#646464',
                            margin: [0, 10, 0, 10]
                        },

                        // IBAN Bilgisi
                        {
                            text: 'Ã–deme Bilgileri',
                            fontSize: 12,
                            bold: true,
                            color: '#38761d',
                            margin: [0, 10, 0, 5]
                        },
                        {
                            text: 'Ä°LKER UZUNER',
                            fontSize: 10,
                            bold: true,
                            margin: [0, 0, 0, 3]
                        },
                        {
                            text: 'TR600001200171900009109685',
                            fontSize: 10,
                            margin: [0, 0, 0, 3]
                        },
                        {
                            text: 'Halkbank GÄ°RESUN ÅžUBESÄ°',
                            fontSize: 10,
                            margin: [0, 0, 0, 15]
                        },

                        // GeÃ§erlilik Notu
                        {
                            text: 'Not: Bu sipariÅŸ formu 7 (yedi) gÃ¼n geÃ§erli olup Ã¶deme yaptÄ±ÄŸÄ±nÄ±zda lÃ¼tfen dekontu iletiniz.',
                            fontSize: 9,
                            italics: true,
                            color: '#646464',
                            margin: [0, 0, 0, 10]
                        },

                        // Destek HattÄ±
                        {
                            text: 'Destek HattÄ±: 0542 183 40 28',
                            fontSize: 9,
                            color: '#38761d',
                            bold: true,
                            margin: [0, 10, 0, 0]
                        }
                    ],
                    styles: {
                        header: {
                            fontSize: 18,
                            bold: true
                        }
                    }
                };

                // PDF oluÅŸtur ve indir
                try {
                    if (typeof pdfMake !== 'undefined') {
                        pdfMake.createPdf(docDefinition).download(`Siparis_${data.name.replace(/\s/g, '_')}_${Date.now()}.pdf`);
                        alert('PDF baÅŸarÄ±yla oluÅŸturuldu ve indirildi!');
                    } else {
                        alert('PDF kÃ¼tÃ¼phanesi yÃ¼klenemedi. LÃ¼tfen sayfayÄ± yenileyin.');
                    }
                } catch (error) {
                    console.error('PDF oluÅŸturma hatasÄ±:', error);
                    alert('PDF oluÅŸturulurken bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.');
                }
            }
            
            // Sayfa yÃ¼klendiÄŸinde baÅŸlangÄ±Ã§ fiyatÄ±nÄ± (0) gÃ¶ster.
            updatePrice();

        });
        // JavaScript BitiÅŸi
    </script>
</body>
</html>